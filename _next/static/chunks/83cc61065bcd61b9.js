(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,64235,e=>{"use strict";e.s(["default",()=>a]);var t=e.i(43476),n=e.i(71645);function a(){let[e,a]=(0,n.useState)(""),[r,s]=(0,n.useState)([]),[l,i]=(0,n.useState)(!1),[o,d]=(0,n.useState)(0);async function c(t){t.preventDefault();let n=Date.now(),r=n-o;if(r<3e3)return void s(e=>[...e,{type:"bot",content:"Lütfen ".concat(Math.ceil((3e3-r)/1e3)," saniye bekleyin.")}]);if(!e.trim())return void s(e=>[...e,{type:"bot",content:"Lütfen bir soru yazın."}]);a(""),s(t=>[...t,{type:"user",content:e}]),i(!0),d(n);try{let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),n=await t.json();if(!n.ok)return void s(e=>[...e,{type:"bot",content:n.error}]);let a="İşte sonuçlar:",r=e.toLowerCase();if(r.includes("en çok dinlenen şarkı")&&!r.includes("şarkılar"))a="İşte en çok dinlenen şarkı:";else if(r.includes("en çok dinlenen")&&r.includes("şarkı")){let t=e.match(/(\d+)/);a=t?"İşte en çok dinlenen ".concat(t[1]," şarkı:"):"İşte en çok dinlenen şarkılar:"}else if(r.includes("en popüler şarkı")&&!r.includes("şarkılar"))a="İşte en popüler şarkı:";else if(r.includes("en çok dinlenen sanatçı")&&!r.includes("sanatçılar"))a="İşte en çok dinlenen sanatçı:";else if(r.includes("en çok dinlenen")&&r.includes("sanatçı")){let t=e.match(/(\d+)/);a=t?"İşte en çok dinlenen ".concat(t[1]," sanatçı:"):"İşte en çok dinlenen sanatçılar:"}else r.includes("hangi şarkı")?a="İşte aradığınız şarkı:":r.includes("hangi sanatçı")&&(a="İşte aradığınız sanatçı:");s(e=>[...e,{type:"bot",content:a,data:n.rows}])}catch(e){s(e=>[...e,{type:"bot",content:"Bağlantı hatası. Lütfen tekrar deneyin."}])}finally{i(!1)}}return(0,t.jsxs)("div",{className:"h-[45vh] lg:h-[92vh] flex flex-col bg-gray-900",children:[(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-2 lg:p-4 space-y-2 lg:space-y-4 bg-gray-900 pb-0",children:[0===r.length&&(0,t.jsx)("div",{className:"text-center text-gray-400 mt-20",children:(0,t.jsx)("p",{children:"2013-2015 Spotify verileri hakkında soru sorun!"})}),r.map((e,n)=>(0,t.jsx)("div",{className:"flex ".concat("user"===e.type?"justify-end":"justify-start"),children:(0,t.jsxs)("div",{className:"max-w-[280px] sm:max-w-xs lg:max-w-md px-3 lg:px-4 py-2 rounded-lg text-sm lg:text-base ".concat("user"===e.type?"bg-green-500 text-white":"bg-gray-700 text-green-400 shadow-sm border border-green-600"),children:[(0,t.jsx)("p",{children:e.content}),"bot"===e.type&&e.data&&e.data.length>0&&(0,t.jsx)("div",{className:"mt-2 space-y-1",children:e.data.map((e,n)=>(0,t.jsx)("div",{className:"text-sm",children:e.track_name&&e.artist_name?(0,t.jsxs)("div",{children:[String(e.track_name)," - ",String(e.artist_name)]}):Object.entries(e).filter(e=>{let[t]=e;return!t.includes("_ms")&&!t.includes("ms_")}).map(e=>{let[n,a]=e,r=n,s=String(a);if("total_hours"===n){r="";let e=Math.round(parseFloat(String(a)));s="".concat(e.toLocaleString()," saat")}else"artist_name"===n?r="Sanatçı":"track_name"===n?r="Şarkı":"total_plays"===n?(r="",s="".concat(parseInt(String(a)).toLocaleString()," kez dinlendi")):"total_listeners"===n?(r="",s="".concat(parseInt(String(a)).toLocaleString()," dinleyici")):"avg_plays"===n&&(r="",s="Ortalama ".concat(parseFloat(String(a)).toFixed(1)," dinleme"));return(0,t.jsxs)("span",{className:"inline-block mr-2",children:[r&&(0,t.jsxs)("strong",{children:[r,": "]}),s]},n)})},n))})]})},n)),l&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsx)("div",{className:"bg-gray-700 text-green-400 shadow-sm border border-green-600 px-3 lg:px-4 py-2 rounded-lg text-sm lg:text-base",children:(0,t.jsx)("p",{children:"AI yanıt oluşturuyor..."})})})]}),(0,t.jsx)("div",{className:"p-2 bg-gray-800 border-t border-green-600",children:(0,t.jsxs)("form",{onSubmit:c,className:"flex gap-2",children:[(0,t.jsx)("input",{className:"flex-1 border border-green-600 rounded-lg px-3 lg:px-4 py-2 text-sm lg:text-base text-green-400 bg-gray-700 focus:outline-none focus:ring-2 focus:ring-green-500 placeholder-gray-500",value:e,onChange:e=>a(e.target.value),placeholder:"Örn: 2014'te en çok dinlenen şarkı hangisi?",disabled:l,maxLength:500}),(0,t.jsx)("button",{className:"px-4 lg:px-6 py-2 rounded-lg bg-green-500 text-white hover:bg-green-600 disabled:bg-gray-600 disabled:cursor-not-allowed text-sm lg:text-base",disabled:l||!e.trim(),children:l?"...":"Gönder"})]})})]})}}]);